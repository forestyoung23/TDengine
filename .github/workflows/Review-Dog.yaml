
name: Review Dog
description: 
  This workflow is triggered when a pull request is opened. It generates a GitHub App token, checks out the repository, and runs the autocorrect action. If the action fails, it reports the results using ReviewDog.
on:
  pull_request:
    # test message13
    types: [opened]

jobs:
  label-pr:
    runs-on: ubuntu-latest

    steps:
        - name: Checkout Repository
          uses: actions/checkout@v4

        - name: Generate GitHub App Token
          id: app-token
          uses: tibdex/github-app-token@v1
          with:
            app_id: ${{ vars.TAOSDATA_BOT_ID }}
            private_key: ${{ secrets.TAOSDATA_BOT_KEY }}

        - name: AutoCorrect
          uses: huacnlee/autocorrect-action@v2

        - name: Report ReviewDog
          if: failure()
          uses: huacnlee/autocorrect-action@v2
          env : 
            REVIEWDOG_GITHUB_API_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          with:
            reviewdog: true